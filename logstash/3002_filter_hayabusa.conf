filter {
    if [type] == "hayabusa" {
        csv {
            skip_header => true
            columns => ["Timestamp","Computer","Channel","EventID","Level","RecordID","RuleTitle","Details","ExtraFieldInfo"]
        }
        
        date {
            # 2023-04-11 17:44:42.924 +00:00
            match => [ "Timestamp", "yyyy-MM-dd HH:mm:ss.SSS ZZ"]
            target => "@timestamp"
        }

        ruby {
            path => "/scripts/split_hayabusa_details.rb"
            script_params => {
                "source" => "[Details]"
                "dest" => "[Details]"
            }
        }

        mutate {
            rename => {
                "[Error Code]" => "ErrorCode"
                "[errorCode]" => "ErrorCode"
                "[Error Description]" => "ErrorDescription"
                "[Feature ID]" => "FeatureID"
                "[Feature Name]" => "FeatureName"
                "[jobTitle]" => "JobTitle"
                "[LocalAddr]" => "LocalAddress"
                "[Product Name]" => "ProductName"
                "[Product Version]" => "ProductVersion"
                "[RemoteAddr]" => "RemoteAddress"
                "[SessID]" => "SessionID"
                "[SessionId]" => "SessionID"
                "[type]" => "Type"
            }
        }
    }
}